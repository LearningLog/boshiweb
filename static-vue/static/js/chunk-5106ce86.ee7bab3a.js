(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5106ce86"],{1540:function(e,t,n){},a888:function(e,t,n){"use strict";n("a481"),n("6762"),n("2fdb");var r={bind:function(e,t,n){var r=e.querySelector(".el-dialog__header"),s=e.querySelector(".el-dialog");r.style.cssText+=";cursor:move;",s.style.cssText+=";top:0px;";var i=function(){return window.document.currentStyle?function(e,t){return e.currentStyle[t]}:function(e,t){return getComputedStyle(e,!1)[t]}}();r.onmousedown=function(e){var t=e.clientX-r.offsetLeft,a=e.clientY-r.offsetTop,o=s.offsetWidth,c=s.offsetHeight,m=document.body.clientWidth,l=document.body.clientHeight,u=s.offsetLeft,d=m-s.offsetLeft-o,f=s.offsetTop,p=l-s.offsetTop-c,g=i(s,"left"),h=i(s,"top");g.includes("%")?(g=+document.body.clientWidth*(+g.replace(/\%/g,"")/100),h=+document.body.clientHeight*(+h.replace(/\%/g,"")/100)):(g=+g.replace(/\px/g,""),h=+h.replace(/\px/g,"")),document.onmousemove=function(e){var r=e.clientX-t,i=e.clientY-a;-r>u?r=-u:r>d&&(r=d),-i>f?i=-f:i>p&&(i=p),s.style.cssText+=";left:".concat(r+g,"px;top:").concat(i+h,"px;"),n.child.$emit("dragDialog")},document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null}}}},s=function(e){e.directive("el-drag-dialog",r)};window.Vue&&(window["el-drag-dialog"]=r,Vue.use(s)),r.install=s;t["a"]=r},ca62:function(e,t,n){"use strict";var r=n("1540"),s=n.n(r);s.a},e24c:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-edit"},[n("el-form",{ref:"form",staticClass:"form",attrs:{model:e.form,rules:e.rules,"status-icon":!0,"label-width":"120px"}},[n("el-form-item",{staticClass:"required",attrs:{label:"权限名称",prop:"permissionname"}},[n("el-input",{attrs:{placeholder:"请输入权限名称",clearable:""},model:{value:e.form.permissionname,callback:function(t){e.$set(e.form,"permissionname",t)},expression:"form.permissionname"}})],1),e._v(" "),n("el-form-item",{staticClass:"required",attrs:{label:"权限标识",prop:"permissionmark"}},[n("el-input",{attrs:{placeholder:"请输入权限标识",clearable:""},model:{value:e.form.permissionmark,callback:function(t){e.$set(e.form,"permissionmark",t)},expression:"form.permissionmark"}})],1),e._v(" "),n("el-form-item",{staticClass:"required",attrs:{label:"权限code",prop:"permissioncode"}},[n("el-input",{attrs:{placeholder:"请输入权限code",clearable:""},model:{value:e.form.permissioncode,callback:function(t){e.$set(e.form,"permissioncode",t)},expression:"form.permissioncode"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"权限描述"}},[n("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入权限描述"},model:{value:e.form.permissiondesc,callback:function(t){e.$set(e.form,"permissiondesc",t)},expression:"form.permissiondesc"}})],1),e._v(" "),n("el-form-item",{staticClass:"required",attrs:{label:"所属菜单",prop:"permissionbelongmenu2"}},[n("span",{staticClass:"pointer actcolor",on:{click:e.show_menu_tree_fn}},[e._v(e._s(e.menu_tip_txt))]),e._v(" "),n("el-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],model:{value:e.form.permissionbelongmenu2,callback:function(t){e.$set(e.form,"permissionbelongmenu2",t)},expression:"form.permissionbelongmenu2"}})],1),e._v(" "),n("el-form-item",{staticClass:"required",attrs:{label:"权限类别",prop:"permissionmanage"}},[n("el-radio-group",{model:{value:e.form.permissionmanage,callback:function(t){e.$set(e.form,"permissionmanage",t)},expression:"form.permissionmanage"}},e._l(e.manage_type,function(t){return n("el-radio",{key:t.permissionmanage,attrs:{label:t.permissionmanage}},[e._v(e._s(t.name))])}),1)],1)],1),e._v(" "),n("div",{attrs:{id:"btnGroup"}},[n("el-button",{directives:[{name:"no-more-click",rawName:"v-no-more-click"}],attrs:{type:"primary"},on:{click:function(t){return e.save("form")}}},[e._v("提交")]),e._v(" "),n("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.cancel("form")}}},[e._v("取消")])],1),e._v(" "),n("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:"所属菜单",visible:e.menu_tree_flag,width:"50%"},on:{"update:visible":function(t){e.menu_tree_flag=t}}},[n("div",{staticClass:"menu_tree_box"},[n("el-scrollbar",{attrs:{"wrap-class":"scrollbar-wrapper"}},[n("el-tree",{ref:"tree",attrs:{data:e.treeData,props:e.defaultProps,"show-checkbox":"","node-key":"id","check-strictly":!0,"expand-on-click-node":!1,"check-on-click-node":!0,"default-expand-all":"","highlight-current":""},on:{"check-change":e.menu_tree_check_fn}})],1)],1),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:e.save_menu}},[e._v("确认")]),e._v(" "),n("el-button",{attrs:{type:"primary",plain:""},on:{click:e.cancel_menu}},[e._v("取消")])],1)])],1)},s=[],i=(n("ac6a"),n("55dd"),n("ea8f")),a=n("a888"),o={directives:{elDragDialog:a["a"]},data:function(){return{dataIsChange:0,noLeaveprompt:!1,form:{permissionname:"",permissionmark:"",permissioncode:"",permissiondesc:"",permissionbelongmenu:[],permissionmanage:"",permissionbelongmenu2:""},menu_dt:[],treeData:[],menu_tip_txt:"请选择菜单",menu_tree_flag:!1,menu_tree_checked:{ids:[],checkey:[],dt:{},lables:[]},manage_type:[],defaultProps:{children:"children",label:"label"},rules:{permissionname:[{required:!0,message:"请输入权限名称（长度在 1 到 64 个字符）",trigger:"blur"},{required:!0,message:"请输入权限名称（长度在 1 到 64 个字符）",trigger:"change"},{min:1,max:64,message:"长度在 1 到 64 个字符",trigger:"blur"},{min:1,max:64,message:"长度在 1 到 64 个字符",trigger:"change"}],permissionmark:[{required:!0,message:"请输入权限标识（长度在 1 到 64 个字符）",trigger:"blur"},{required:!0,message:"请输入权限标识（长度在 1 到 64 个字符）",trigger:"change"},{min:1,max:64,message:"长度在 1 到 64 个字符",trigger:"blur"},{min:1,max:64,message:"长度在 1 到 64 个字符",trigger:"change"}],permissioncode:[{required:!0,message:"请输入权限code（长度在 1 到 64 个字符）",trigger:"blur"},{required:!0,message:"请输入权限code（长度在 1 到 64 个字符）",trigger:"change"},{min:1,max:64,message:"长度在 1 到 64 个字符",trigger:"blur"},{min:1,max:64,message:"长度在 1 到 64 个字符",trigger:"change"}],permissionbelongmenu2:[{required:!0,message:"请选择所属菜单",trigger:"blur"},{required:!0,message:"请选择所属菜单",trigger:"change"}],permissionmanage:[{required:!0,message:"请选择权限类别",trigger:"change"}]}}},watch:{form:{handler:function(e){e&&this.dataIsChange++},deep:!0}},mounted:function(){},created:function(){this.get_menu(),this.get_permission_manage_type()},methods:{get_menu:function(){var e=this,t={};Object(i["g"])(t).then(function(t){var n=t.data.MenuV2List;e.menu_dt=e.translate(n),e.treeData=e.menu_dt[0]})},get_permission_manage_type:function(){var e=this,t={};Object(i["f"])(t).then(function(t){e.manage_type=t.data})},translate:function(e){if(!(e&&e.length>0))return[];var t={},n=[],r={},s={},i=[];i.push(n);for(var a=function(e){if(e in s)return s[e];var t=[];return s[e]=t,i.push(t),s[e]},o=0;o<e.length;o++){var c=e[o],m={},l=c["_id"],u=a(c.cid);m["label"]=c["menuname"],m["children"]=u,m["orders"]=c["orders"],m["id"]=c["_id"],t[l]=m;var d=c.pid;if("firstMenu"===d)n.push(m);else{var f=a(d);f.push(m)}r[c.cid]=m}for(var p=function(e,t){return e.orders-t.orders},g=0;g<i.length;g++){var h=i[g];h.sort(p)}var _={},v=function e(n,r){if(n&&n.length>0)for(var s=0;s<n.length;s++){var i=n[s],a=i.id,o=[];if(r&&r.length>0)for(var c=0;c<r.length;c++){var m=r[0],l=t[m];o.push({id:m,label:l.label})}o.push({id:a,label:i.label}),_[a]=o;var u=i.children;if(u&&u.length>0){var d=r.concat();d.push(a),e(u,d)}}};return v(n,[]),[n,_]},show_menu_tree_fn:function(){var e=this.menu_tree_checked.ids;if(0!==e.length){var t=e[e.length-1];this.$refs.tree.setCheckedKeys([t])}this.menu_tree_flag=!0},menu_tree_check_fn:function(e,t,n){if(this.menu_tree_checked.checkey=[e.id],!0===t){var r=[],s=[],i=e.id,a=this.menu_dt[1],o=a[i];o.forEach(function(e){r.push(e.id),s.push(e.label)}),this.menu_tree_checked.ids=r,this.menu_tree_checked.lables=s,this.$refs.tree.setCheckedKeys([e.id]),this.menu_tree_checked.dt=e}else this.menu_tree_checked.id===e.id&&this.$refs.tree.setCheckedKeys([e.id])},save_menu:function(){var e=this.menu_tree_checked.lables,t="";e.forEach(function(e){t+=e+"/"}),this.menu_tip_txt=t.substring(0,t.length-1),this.form.permissionbelongmenu=this.menu_tree_checked.ids,this.form.permissionbelongmenu2=this.form.permissionbelongmenu.length?"11111":"",this.menu_tree_flag=!1},cancel_menu:function(){this.menu_tree_flag=!1,this.menu_tree_checked.ids===[]&&(this.$refs.tree.setCheckedKeys([]),this.menu_tree_checked={ids:[],checkey:[],dt:{},lables:[]},this.menu_tip_txt="请选择菜单")},save:function(e){var t=this;this.$refs[e].validate(function(e){if(e){if(t.form.permissionbelongmenu===[])return void t.$message.error("请选择菜单！");if(""===t.form.permissionmanage)return void t.$message.warning("请选择权限类别！");Object(i["a"])(t.form).then(function(e){t.$message.success("新增权限成功！"),t.noLeaveprompt=!0;var n=e.data.resId;t.$router.push({path:"/systemManage/permissionManage/detail",query:{ids:n}})})}})},cancel:function(e){this.$router.push({path:"/systemManage/permissionManage/list"})}},beforeRouteLeave:function(e,t,n){var r=this;this.dataIsChange&&!this.noLeaveprompt?setTimeout(function(){r.$confirm("您的数据尚未保存，是否离开？","离开页面",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n()}).catch(function(){n(!1)})},200):n()}},c=o,m=(n("ca62"),n("2877")),l=Object(m["a"])(c,r,s,!1,null,"0f381e02",null);t["default"]=l.exports},ea8f:function(e,t,n){"use strict";n.d(t,"e",function(){return s}),n.d(t,"g",function(){return i}),n.d(t,"f",function(){return a}),n.d(t,"a",function(){return o}),n.d(t,"d",function(){return c}),n.d(t,"b",function(){return m}),n.d(t,"c",function(){return l});var r=n("b775");function s(e){return Object(r["a"])({url:"/system/permissionV2/findPermissionList",method:"post",data:e})}function i(e){return Object(r["a"])({url:"/system/menuV2/findAllMenus",method:"post",data:e})}function a(e){return Object(r["a"])({url:"/system/permissionV2/getDefaultManage",method:"post",data:e})}function o(e){return Object(r["a"])({url:"/system/permissionV2/addPermissionInfo",method:"post",data:e})}function c(e){return Object(r["a"])({url:"/system/permissionV2/updatePermissionInfo",method:"post",data:e})}function m(e){return Object(r["a"])({url:"/system/permissionV2/deletePermissionInfo",method:"post",data:e})}function l(e){return Object(r["a"])({url:"/system/permissionV2/findPermissionById",method:"post",data:e})}}}]);